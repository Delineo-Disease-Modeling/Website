{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Mathias\\\\Documents\\\\Delineo\\\\Website\\\\model_app\\\\frontend\\\\src\\\\containers\\\\Simulator.js\";\nimport React, { Component } from 'react';\nimport { Place, GoogleMap, Parameters, OptionMenu, SimulationTimeseries, PersistentDrawerLeft } from '../components';\nimport './Simulator.css';\nimport axios from 'axios';\nimport Button from '@material-ui/core/Button';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { withStyles, makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport Fab from '@material-ui/core/Fab';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nconst ColoredAccordion = withStyles({\n  root: {\n    backgroundColor: '#1b4441c2',\n    fontSize: '20px',\n    color: '#66FCF1'\n  }\n})(Accordion);\nconst useStyles = makeStyles(theme => ({\n  root: {\n    backgroundColor: theme.palette.background.paper,\n    width: 400,\n    position: 'relative',\n    minHeight: 200\n  },\n  fab: {\n    position: 'fixed',\n    right: theme.spacing(4),\n    zIndex: 99,\n    color: theme.palette.common.black,\n    backgroundColor: 'cyan',\n    '&:hover': {\n      backgroundColor: '#0fe0e0'\n    }\n  },\n  drawer: {\n    top: 90,\n    height: \"90%\"\n  }\n}));\n\nclass Simulator extends Component {\n  // classes = useStyles();\n  constructor() {\n    super();\n\n    this.handleOnClick = () => {\n      // if user had an existing job request, delete that\n      if (this.state.jobId) {\n        axios.delete(`./simulations/${this.state.jobId}`, {\n          cancelToken: this.source.token\n        }).catch(err => {\n          if (axios.isCancel(err)) {\n            console.log('Request canceled:', err.message);\n          } else {\n            console.log(err);\n          }\n        });\n      } // configure post body with specific model params\n\n\n      let body = {}; // send post request\n\n      axios.post('./simulations', body, {\n        cancelToken: this.source.token\n      }).then(res => {\n        // only upon successful post request, update state with in progress state and\n        if (res.status === 200) {\n          this._isMounted && this.setState({\n            jobId: `${res.data}`,\n            loading: true\n          });\n          console.log('post sent with job id ' + res.data);\n          axios.get(`./simulations/${res.data}`, {\n            cancelToken: this.source.token\n          }).then(result => {\n            this._isMounted && this.setState({\n              loading: false,\n              data: [...result.data]\n            });\n            console.log('simulation finished running');\n          }).catch(err => {\n            if (axios.isCancel(err)) {\n              console.log('Request canceled:', err.message);\n            } else {\n              console.log(err);\n            }\n          }); // should probably save data to redux store\n          // maybe also save jobId? idk yet\n        }\n      }).catch(err => {\n        if (axios.isCancel(err)) {\n          console.log('Request canceled:', err.message);\n        } else {\n          console.log(err);\n        }\n      });\n    };\n\n    this.state = {\n      hidden: false,\n      policy: '',\n      data: [],\n      loading: false,\n      jobId: null\n    };\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.source = axios.CancelToken.source();\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n    this.source.cancel('Operation canceled by the user.'); // remove existing job request, if it existed\n\n    if (this.state.jobId) {\n      axios.delete(`./simulations/${this.state.jobId}`).catch(err => console.log(err));\n    }\n  } //<p style={{ textAlign: 'left', fontSize: '20px', color: '#66FCF1' }}>Model Parameters</p>\n\n\n  render() {\n    const {\n      data,\n      jobId,\n      loading\n    } = this.state; // no timeseries: replace with simulation timeseries\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"GreenBackground\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      spacing: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      xs: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"GreenBackground\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 29\n      }\n    }, \"Configurations\"), /*#__PURE__*/React.createElement(ColoredAccordion, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(AccordionSummary, {\n      expandIcon: /*#__PURE__*/React.createElement(ExpandMoreIcon, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 47\n        }\n      }),\n      \"aria-controls\": \"Model Param-content\",\n      id: \"Model Param-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 31\n      }\n    }, \"Model Parameters\"), /*#__PURE__*/React.createElement(Parameters, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(ColoredAccordion, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(AccordionSummary, {\n      expandIcon: /*#__PURE__*/React.createElement(ExpandMoreIcon, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 47\n        }\n      }),\n      \"aria-controls\": \"Intervention Policy-content\",\n      id: \"Intervention Policy-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 31\n      }\n    }, \"Intervention Policy\"), /*#__PURE__*/React.createElement(OptionMenu, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      className: \"button\",\n      onClick: this.handleOnClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 29\n      }\n    }, \"Run Simulation\"))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 21\n      }\n    }, jobId ? loading ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 45\n      }\n    }, \"loading...\") : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"GreenBackground\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 33\n      }\n    }, \"Analysis\"), /*#__PURE__*/React.createElement(SimulationTimeseries, {\n      infected: data[1],\n      deaths: data[2],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 33\n      }\n    })) : null)), /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      xs: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"GreenBackground\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 25\n      }\n    }, \"Map\"), /*#__PURE__*/React.createElement(Place, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(GoogleMap, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 25\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"fab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(Fab, {\n      variant: \"extended\",\n      style: {\n        'bottom': '40px'\n      },\n      onClick: this.handleOnClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(PlayArrowIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 13\n      }\n    }), \" Run Simulation\")));\n  }\n\n}\n\nexport default Simulator;","map":{"version":3,"sources":["C:/Users/Mathias/Documents/Delineo/Website/model_app/frontend/src/containers/Simulator.js"],"names":["React","Component","Place","GoogleMap","Parameters","OptionMenu","SimulationTimeseries","PersistentDrawerLeft","axios","Button","Accordion","AccordionSummary","ExpandMoreIcon","withStyles","makeStyles","Grid","Fab","PlayArrowIcon","ColoredAccordion","root","backgroundColor","fontSize","color","useStyles","theme","palette","background","paper","width","position","minHeight","fab","right","spacing","zIndex","common","black","drawer","top","height","Simulator","constructor","handleOnClick","state","jobId","delete","cancelToken","source","token","catch","err","isCancel","console","log","message","body","post","then","res","status","_isMounted","setState","data","loading","get","result","hidden","policy","componentDidMount","CancelToken","componentWillUnmount","cancel","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Place, GoogleMap, Parameters, OptionMenu, SimulationTimeseries, PersistentDrawerLeft } from '../components';\r\nimport './Simulator.css'\r\nimport axios from 'axios';\r\nimport Button from '@material-ui/core/Button';\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport {withStyles, makeStyles} from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\r\n\r\nconst ColoredAccordion = withStyles({\r\n    root: {\r\n        backgroundColor: '#1b4441c2',\r\n        fontSize: '20px',\r\n        color: '#66FCF1'\r\n\r\n\r\n\r\n    },\r\n})(Accordion);\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n      backgroundColor: theme.palette.background.paper,\r\n      width: 400,\r\n      position: 'relative',\r\n      minHeight: 200,\r\n    },\r\n    fab: {\r\n      position: 'fixed',\r\n      right: theme.spacing(4),\r\n      zIndex: 99,\r\n      color: theme.palette.common.black,\r\n      backgroundColor: 'cyan',\r\n      '&:hover': {\r\n        backgroundColor: '#0fe0e0',\r\n      },\r\n    },\r\n    drawer: {\r\n      top: 90,\r\n      height: \"90%\"\r\n    }\r\n  }));\r\n\r\nclass Simulator extends Component {\r\n    // classes = useStyles();\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            hidden: false,\r\n            policy: '',\r\n            data: [],\r\n            loading: false,\r\n            jobId: null,\r\n        };\r\n        this._isMounted = false;\r\n    }\r\n\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n        this.source = axios.CancelToken.source();\r\n    }\r\n\r\n    handleOnClick = () => {\r\n        // if user had an existing job request, delete that\r\n        if (this.state.jobId) {\r\n            axios.delete(`./simulations/${this.state.jobId}`, { cancelToken: this.source.token })\r\n                .catch(err => {\r\n                    if (axios.isCancel(err)) {\r\n                        console.log('Request canceled:', err.message);\r\n                    } else { console.log(err) }\r\n                });\r\n        }\r\n\r\n        // configure post body with specific model params\r\n        let body = {};\r\n\r\n        // send post request\r\n        axios.post('./simulations', body, { cancelToken: this.source.token })\r\n            .then(res => {\r\n                // only upon successful post request, update state with in progress state and\r\n                if (res.status === 200) {\r\n                    this._isMounted && this.setState({ jobId: `${res.data}`, loading: true });\r\n                    console.log('post sent with job id ' + res.data);\r\n\r\n                    axios.get(`./simulations/${res.data}`, { cancelToken: this.source.token })\r\n                        .then(result => {\r\n                            this._isMounted && this.setState({ loading: false, data: [...result.data] });\r\n                            console.log('simulation finished running');\r\n                        })\r\n                        .catch(err => {\r\n                            if (axios.isCancel(err)) {\r\n                                console.log('Request canceled:', err.message);\r\n                            } else { console.log(err) }\r\n                        });\r\n\r\n                    // should probably save data to redux store\r\n                    // maybe also save jobId? idk yet\r\n                }\r\n            })\r\n            .catch(err => {\r\n                if (axios.isCancel(err)) {\r\n                    console.log('Request canceled:', err.message);\r\n                } else { console.log(err) }\r\n            });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n        this.source.cancel('Operation canceled by the user.');\r\n\r\n        // remove existing job request, if it existed\r\n        if (this.state.jobId) {\r\n            axios.delete(`./simulations/${this.state.jobId}`)\r\n                .catch(err => console.log(err));\r\n        }\r\n    }\r\n    //<p style={{ textAlign: 'left', fontSize: '20px', color: '#66FCF1' }}>Model Parameters</p>\r\n\r\n    render() {\r\n        const { data, jobId, loading } = this.state;\r\n\r\n        // no timeseries: replace with simulation timeseries\r\n        return (\r\n            <div className='GreenBackground'>\r\n                 <Grid container spacing={3}>\r\n                 <Grid item xs={6}>\r\n<div>\r\n                        <div className='GreenBackground'>\r\n                            <h3>Configurations</h3>\r\n                            <ColoredAccordion>\r\n                              <AccordionSummary\r\n                                  expandIcon={<ExpandMoreIcon />}\r\n                                  aria-controls=\"Model Param-content\"\r\n                                  id=\"Model Param-header\"\r\n                              >\r\n                                Model Parameters\r\n                              </AccordionSummary>\r\n                                <Parameters />\r\n                            </ColoredAccordion>\r\n                            <br></br>\r\n                            <ColoredAccordion>\r\n                              <AccordionSummary\r\n                                  expandIcon={<ExpandMoreIcon />}\r\n                                  aria-controls=\"Intervention Policy-content\"\r\n                                  id=\"Intervention Policy-header\"\r\n                              >\r\n                                Intervention Policy\r\n                              </AccordionSummary>\r\n                                <OptionMenu />\r\n                            </ColoredAccordion>\r\n\r\n                            <br></br>\r\n\r\n                            <Button variant=\"contained\" color=\"primary\" className='button' onClick={this.handleOnClick}>\r\n                                Run Simulation\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div>\r\n                        {jobId ? (loading ? <p>loading...</p> :\r\n                            <div className='GreenBackground'>\r\n                                <h3>Analysis</h3>\r\n                                <SimulationTimeseries infected={data[1]} deaths={data[2]} />\r\n                            </div>)\r\n                            : null}\r\n                    </div>\r\n                     </Grid>\r\n                 <Grid item xs={6}>\r\n                    <div className='GreenBackground'>\r\n                        <h3>Map</h3>\r\n                        <Place />\r\n                        <GoogleMap />\r\n                    </div>\r\n\r\n                    \r\n                </Grid>\r\n                </Grid>\r\n\r\n<div className='fab'>\r\n          <Fab variant=\"extended\"  style={{'bottom': '40px'}} onClick={this.handleOnClick}>\r\n            <PlayArrowIcon  /> Run Simulation \r\n          </Fab>\r\n            </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default Simulator;\r\n"]},"metadata":{},"sourceType":"module"}